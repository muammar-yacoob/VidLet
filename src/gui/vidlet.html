<!DOCTYPE html>
<html data-vidlet data-width="420" data-height="320">
<head>
  <meta charset="UTF-8">
  <title>VidLet</title>
  <link rel="stylesheet" href="/css/theme.css">
  <link rel="icon" href="/favicon.ico">
  <style>
    .tools{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;flex:1;padding:8px 0}
    .tool{display:flex;flex-direction:column;align-items:center;gap:6px;padding:12px 8px;background:var(--bg2);border:1px solid var(--brd);border-radius:8px;cursor:pointer;transition:all .15s}
    .tool:hover{background:var(--bg3);border-color:var(--acc)}
    .tool img{width:32px;height:32px}
    .tool span{font-size:11px;color:var(--txt2)}
    .tool:hover span{color:var(--txt)}
  </style>
</head>
<body>
  <div class="app">
    <div class="hd">
      <b>VidLet</b>
      <span id="fileName">-</span>
    </div>

    <div class="meta" id="meta">
      <div>Size: <b id="size">-</b></div>
      <div>Duration: <b id="duration">-</b></div>
      <div>FPS: <b id="fps">-</b></div>
    </div>

    <div class="tools" id="tools">
      <div class="tool" onclick="openTool('compress')">
        <img src="/icons/compress.ico" alt="Compress">
        <span>Compress</span>
      </div>
      <div class="tool" onclick="openTool('togif')">
        <img src="/icons/togif.ico" alt="To GIF">
        <span>To GIF</span>
      </div>
      <div class="tool" onclick="openTool('mkv2mp4')">
        <img src="/icons/mkv2mp4.ico" alt="MKV to MP4">
        <span>MKV to MP4</span>
      </div>
      <div class="tool" onclick="openTool('shrink')">
        <img src="/icons/shrink.ico" alt="Shrink">
        <span>Shrink</span>
      </div>
      <div class="tool" onclick="openTool('loop')">
        <img src="/icons/loop.ico" alt="Loop">
        <span>Loop</span>
      </div>
      <div class="tool" onclick="openTool('thumb')">
        <img src="/icons/thumb.ico" alt="Thumbnail">
        <span>Thumbnail</span>
      </div>
    </div>

    <div class="btns" id="btns">
      <button class="btn btn-g" onclick="VidLet.cancel()">Close</button>
    </div>
  </div>

  <script src="/js/vidlet.js"></script>
  <script>
    const { $, formatDuration } = VidLet;

    async function init() {
      const res = await VidLet.fetchJson('/api/info');
      $('fileName').textContent = res.fileName;
      $('size').textContent = `${res.width}x${res.height}`;
      $('duration').textContent = formatDuration(res.duration);
      $('fps').textContent = res.fps ? res.fps.toFixed(1) : '-';
    }

    function openTool(tool) {
      window.location.href = `/${tool}.html`;
    }

    init();
  </script>
</body>
</html>
